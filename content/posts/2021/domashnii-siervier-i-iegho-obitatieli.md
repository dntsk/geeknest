---
title: "Домашний сервер и его обитатели"
date: 2021-01-22
author: "Silver Ghost"
tags: ["Самохостинг"]
image: "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDF8fHNlcnZlcnxlbnwwfHx8fDE3Mzk3Mzc4NjN8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000"
description: "Вероятно пора рассказать о своем домашнем сервачке, а то часто спрашивают как и что. Краткая версия этой заметки была в твиттере, тут же дам немного больше инфы и ссылок на то, как все устроено.


Железо

 * Процессор - Intel(R) Pentium(R) CPU G3260 @ 3.30GHz
 * Материнская плата - AsRock H81M-VG4"
---

Вероятно пора рассказать о своем домашнем сервачке, а то часто спрашивают как и что. Краткая версия этой заметки была в твиттере, тут же дам немного больше инфы и ссылок на то, как все устроено.

## Железо

- Процессор - Intel(R) Pentium(R) CPU G3260 @ 3.30GHz
- Материнская плата - AsRock H81M-VG4 R4.0
- Операционная система установлена на SSD Intel 120GB
- Хранилище - 3x3TB WD Blue/Red собранный в RAID-5
- Память - 16ГБ

## Операционная система

В качестве операционки я использую на данный момент Ubuntu 18.04.4 с планом мигрировать на 20.04.
Раньше была 16.04 и я переехал простым апгрейдом без особых проблем.

## Софт, установленный прямо в системе

- Minidlna раздает скачанное медиа на телевизоры (хотя в нем нет уже особого смысла, почти полностью его заменил Plex)
- rsnapshot делает бэкапы удаленных серверов
- haproxy выступает лоадбалансером для проброса портов в k8s
- openvpn в качестве клиента для обхода некоторых блокировок

Итого по софту, установленному в системе: уже можно отказаться от minidlna и заменить haproxy на MetalLB. Останется только две простые утилиты и чистая система. Потом можно упаковать rsnapshot в docker и вообще будет огонь. Все остальное развернуто в docker или kubernetes.

## Софт, развернутый с docker-compose

- timecapsule для бэкапов маков
- qbittorrent для автоматического скачивания торрентов
- jackett для поиска по треккерам
- radarr для отслеживания появившихся релизов и добавления в закачки
- plex для просмотра сериальчиков и фильмов
- zoneminder пишет видеопотоки с камер наблюдения на даче
- несколько баз данных для проектов и тестов

## Kubernetes

k8s развернут с помощью kubeadm [этим способом](https://blog.dntsk.dev/k8s-single-node-cluster/?ref=geeknest.ru). Список того, что там крутится:

- несколько простых проектов
- drone agent для DroneCI
- librespeed для тестирования канала в интернет
- piwigo для просмотра архива фоточек
- registry для хранения образов билдов
- smokeping для отслеживания состояния каналов связи
- searx персональная поисковая система

Пока это все, что задеплоено. Но есть еще идеи, что добавить. Например, paperless-ng.

В планах обновить железо до AMD Ryzen и 32 гигов оперативки.
